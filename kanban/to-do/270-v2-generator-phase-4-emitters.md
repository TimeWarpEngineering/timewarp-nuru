# V2 Generator Phase 4: Emitters

## Description

Create emitter classes that transform the `AppModel` IR into generated C# source code. The main output is an interceptor method that replaces `RunAsync()` at compile time.

## Parent

#265 Epic: V2 Source Generator Implementation

## Checklist

### Commit 4.1: Create core emitters (4 files)
- [ ] `interceptor-emitter.cs` - Main entry, emits `RunAsync_Generated`
- [ ] `route-matcher-emitter.cs` - Pattern matching code per route
- [ ] `handler-invoker-emitter.cs` - Handler invocation code
- [ ] `service-resolver-emitter.cs` - Service resolution code

### Commit 4.2: Create feature emitters (3 files)
- [ ] `help-emitter.cs` - `--help` output generation
- [ ] `version-emitter.cs` - `--version` output
- [ ] `capabilities-emitter.cs` - `--capabilities` JSON response
- [ ] Verify build succeeds

## Notes

### InterceptorEmitter Output Structure
```csharp
// <auto-generated/>
#nullable enable

namespace TimeWarp.Nuru.Generators;

using System.Runtime.CompilerServices;

internal static class GeneratedRuntime
{
    [InterceptsLocation("Program.cs", line: 15, column: 16)]
    internal static async Task<int> RunAsync_Generated(
        this NuruCoreApp app, 
        string[] args)
    {
        // Built-in flags
        if (args is ["--help"]) { ... }
        if (args is ["--version"]) { ... }
        if (args is ["--capabilities"]) { ... }
        
        // Route matching (from RouteMatcherEmitter)
        if (args is ["status"]) { ... }
        if (args is ["greet", var name]) { ... }
        
        // No match
        return 1;
    }
}
```

### RouteMatcherEmitter
Generates pattern matching for each route:
- Literal segments: exact match
- Parameters: `var` capture
- Options: handle `--flag` forms
- Catch-all: remaining args

### HandlerInvokerEmitter
Generates handler invocation:
- Delegate handlers: inline lambda call
- Mediator handlers: `app.Mediator.Send(request)`
- Service injection: resolve from provider

### Reference: Existing Emitter
See `reference-only/emitters/runtime-code-emitter.cs` for:
- String escaping utilities
- XML comment escaping
- Segment matcher generation (different pattern but useful)
