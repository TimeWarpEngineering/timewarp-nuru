# Generate Typed Invoker Methods

## Description

Generate compile-time typed invoker methods that cast delegates and invoke without reflection. Each unique delegate signature gets a dedicated invoker method that performs type-safe invocation.

## Parent

008-implement-source-generators-for-reflection-free-routing

## Dependencies

- 008a-extract-delegate-signatures-from-map-calls

## Requirements

- Generate a static invoker method for each unique delegate signature
- Cast Delegate to the correct Action<>/Func<> type
- Cast object[] args to correct parameter types
- Handle return values correctly (void, value types, reference types)
- Use Scriban templates or string building for code generation
- Generate incrementally (only regenerate when signatures change)

## Checklist

### Implementation
- [ ] Create Scriban template for invoker methods
- [ ] Generate Action<> invokers for void returns
- [ ] Generate Func<> invokers for value returns
- [ ] Generate async invokers for Task/Task<T> returns
- [ ] Handle parameter casting with null checks
- [ ] Generate unique method names per signature
- [ ] Emit proper nullable annotations

### Generated Code Shape
```csharp
// <auto-generated/>
internal static class GeneratedRouteInvokers
{
    public static object? Invoke_Action_String(Delegate handler, object?[] args)
    {
        ((Action<string>)handler)((string)args[0]!);
        return null;
    }
    
    public static object? Invoke_Func_Int_Int_Int(Delegate handler, object?[] args)
    {
        return ((Func<int, int, int>)handler)((int)args[0]!, (int)args[1]!);
    }
    
    public static async Task<object?> InvokeAsync_Func_String_TaskInt(Delegate handler, object?[] args)
    {
        return await ((Func<string, Task<int>>)handler)((string)args[0]!);
    }
}
```

### Testing
- [ ] Verify generated code compiles
- [ ] Test invokers with various parameter combinations
- [ ] Test async invokers with Task and Task<T>
- [ ] Verify no reflection warnings in generated code

## Notes

Consider using Scriban like martinothamar/Mediator:
- `Implementation/resources/*.sbn-cs` - Template examples

Key considerations:
- Method naming must be deterministic and unique per signature
- Handle both sync and async delegates
- Ensure generated code is trimmer-friendly
